# 天の蔵 データダウンロード自動化スクリプト

このスクリプトは、Playwrightを使用して天の蔵のWebサイトから売上データと仕入データを自動でダウンロードし、指定されたフォルダに移動します。

## 1. 事前準備

### 1.1. PythonとPlaywrightのインストール

Pythonがインストールされていない場合は、[Python公式サイト](https://www.python.org/downloads/)からダウンロードしてインストールしてください。

次に、コマンドプロンプト（またはPowerShell）を開き、以下のコマンドを実行してPlaywrightとそのブラウザドライバをインストールします。

```bash
pip install playwright python-dotenv
playwright install
```

### 1.2. 認証情報の設定（.envファイル）

セキュリティのため、ログイン情報はスクリプト内に直接記述せず、`.env` ファイルに設定します。

スクリプトと同じフォルダ (`C:\Users\nanayama\Downloads\auto\download-upload`) に、`.env` という名前のファイルを作成し、以下の内容を記述してください。

```
TENKURA_EMAIL="あなたのメールアドレス"
TENKURA_PASSWORD="あなたのパスワード"
```

**注意:**
*   `"あなたのメールアドレス"` と `"あなたのパスワード"` の部分は、実際の天の蔵のログイン情報に置き換えてください。
*   ダブルクォーテーション `"` で囲むのを忘れないでください。
*   この `.env` ファイルは、Gitなどのバージョン管理システムにコミットしないように注意してください（`.gitignore` ファイルで除外設定済みです）。

## 2. スクリプトの実行

`.env` ファイルの設定が完了したら、コマンドプロンプト（またはPowerShell）を開き、以下のコマンドを実行します。

```bash
python C:\Users\nanayama\Downloads\auto\download-upload\download_data.py
```

スクリプトが実行されると、自動的にブラウザが起動し、以下の操作が実行されます。

1.  天の蔵にログインします。
2.  売上一覧画面に移動し、先月の売上伝票CSVをダウンロードします。
3.  ダウンロードした売上伝票CSVファイルをPCの「ドキュメント」フォルダに移動します。
4.  仕入一覧画面に移動し、先月の仕入伝票CSVをダウンロードします。
5.  ダウンロードした仕入伝票CSVファイルをPCの「ドキュメント」フォルダに移動します。

すべてのタスクが完了すると、コマンドプロンプトに完了メッセージが表示されます。

## 3. エラー発生時の対応

もしスクリプトの実行中にエラーが発生した場合、スクリプトと同じフォルダ (`C:\Users\nanayama\Downloads\auto\download-upload`) に `error.png` という名前のスクリーンショットが保存されます。この画像を確認することで、どのステップで問題が発生したかを特定できます。

---

```